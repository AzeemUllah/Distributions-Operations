<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
    <link rel="shortcut icon" type="image/x-icon" href="images/favicon.ico">
    <title>Dependencies List</title>
    <link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500,600,700" rel="stylesheet">
    <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="css/dataTables.bootstrap.min.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="css/select2.min.css" type="text/css">
    <link rel="stylesheet" href="css/bootstrap-datetimepicker.min.css" type="text/css">
    <link href="css/style.css" rel="stylesheet" type="text/css">
    <!--[if lt IE 9]>
    <script src="js//html5shiv.min.js"></script>
    <script src="js/respond.min.js"></script>
    <![endif]-->
</head>
<body class="theme-purple">
<div class="main-wrapper">
    <div class="header">
        <div class="header-left">
            <a href="profile.php" class="logo">
                <img style="margin-top: 8px;" src="images/KnowBusinessTrans.png" height="50" alt="">
            </a>
            <a href="profile.php" class="logo-dark">

            </a>
        </div>
        <div class="page-title-box pull-left">
            <h3>Product Integration</h3>
        </div>
        <a id="mobile_btn" class="mobile_btn pull-left" href="#sidebar"><i class="fa fa-bars" aria-hidden="true"></i></a>




        <div class="dropdown mobile-user-menu pull-right">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false"><i class="fa fa-ellipsis-v"></i></a>
            <ul class="dropdown-menu pull-right">
                <li><a href="profile.html">My Profile</a></li>

                <li><a href="login.php">Logout</a></li>
            </ul>
        </div>
    </div>         <div class="sidebar" id="sidebar">
    <div class="sidebar-inner slimscroll">
        <div id="sidebar-menu" class="sidebar-menu">
            <ul>

                <li>
                    <a href="operations" >Operations</a>
                </li>
                <li>
                    <a href="dependencies">Dependencies</a>
                </li>






            </ul>
        </div>
    </div>
</div>         <div class="page-wrapper">
    <div class="content container-fluid">
        <div class="row">
            <div class="col-xs-4">
                <h4 class="page-title">Dependencies</h4>
            </div>
            <div class="col-xs-8 text-right m-b-30">
                <a href="dependencies/get-dependencies-xls" class="btn btn-primary pull-right rounded" ><i class=""></i> Export To CSV</a>
                <a href="#" class="btn btn-primary pull-right rounded" data-toggle="modal" data-target="#add_employee"><i class="fa fa-plus"></i> Add Dependencies</a>



                <div class="view-icons">
                </div>
            </div>

        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="table-responsive">

                    <table class="table table-striped custom-table datatable">
                        <thead>
                        <tr>
                            <th>Operation Name Calls</th>
                            <th>Operation Name</th>
                            <th>Integration Status</th>
                            <th>Last Updated</th>
                            <th>Comments</th>

                            <th class="text-right">Action</th>
                        </tr>
                        </thead>
                        <tbody id="dependenciesTable">






                        </tbody>
                    </table>
                </div>
            </div>
        </div>








    </div>
</div>
    <div id="add_employee" class="modal custom-modal fade" role="dialog">
        <div class="modal-dialog">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <div class="modal-content modal-lg">
                <div class="modal-header">
                    <h4 class="modal-title">Add Dependencies</h4>
                </div>
                <div class="modal-body">
                    <form class="m-b-30">
                        <div class="row">

                            <hr style="border: 0.5px solid #ffa351;"/>
                            <div class="modal-header">
                                <h4 class="modal-title">Dependencies Details</h4>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label">Operation Name Calls <span class="text-danger">*</span></label>
                                    <select id=operation_name_call class="select operation_name">

                                    </select>

                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label">Operation Name <span class="text-danger">*</span></label>
                                    <select id=operation_name class="select operation_name">

                                    </select>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label">Integration Status <span class="text-danger">*</span></label>

                                    <select id=integration_status class="select">
                                        <option value="Idea">Idea</option>
                                        <option value="Planned">Planned</option>
                                        <option value="Specified">Specified</option>
                                        <option value="In Build">In Build</option>
                                        <option value="In Test">In Test</option>
                                        <option value="Deprecated">Deprecated</option>
                                        <option value="Done">Done</option>


                                    </select>
                                </div>
                            </div>

                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label">Comments</label>
                                    <input id=comments class="form-control" type="text">
                                </div>
                            </div>

                        </div>


                </div>
            </div>

            <div class="m-t-20 text-center">
                <button type=button onclick="addClient();" class="btn btn-primary">Create Dependencies</button>
            </div>
            </form>
        </div>
    </div>
</div>
</div>


<div id="editDependencies">

</div>
<div id="deleteDependencies">

</div>












</div>
<div class="sidebar-overlay" data-reff="#sidebar"></div>
<script type="text/javascript" src="js/jquery-3.2.1.min.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script type="text/javascript" src="js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="js/dataTables.bootstrap.min.js"></script>
<script type="text/javascript" src="js/jquery.slimscroll.js"></script>
<script type="text/javascript" src="js/select2.min.js"></script>
<script type="text/javascript" src="js/moment.min.js"></script>
<script type="text/javascript" src="js/bootstrap-datetimepicker.min.js"></script>
<script type="text/javascript" src="js/app.js"></script>
<script>
  function addClient() {
    $.ajax({
      url: "./dependencies/add-dependencies",
      type: "POST",
      data: {
        operation_name_call: $("#operation_name_call").val(),
        operation_name: $("#operation_name").val(),
        integration_status: $("#integration_status").val(),
        comments: $("#comments").val()
      },
      success: function (data) {
        console.log(data);
        if (data) {
          if(data.status == "ok"){
            window.location="./dependencies"
          }
          else{
            console.log(data);
            alert("Error!");
            //window.location="./seller_list.php"
          }
        }
      },
      error: function (xhr, status, error) {
        var err = eval("(" + xhr.responseText + ")");
        alert(err.Message);
      }
    });
  }


  function deleteClient(id) {
    $.ajax({
      url: "./dependencies/delete-dependencies",
      type: "POST",
      data: {
        id: id
      },
      success: function (data) {
        if (data) {
          if(data.status == "ok"){
            window.location="./dependencies"
          }
          else{
            console.log(data);
            alert("Error!");
          }
        }
      },
      error: function (xhr, status, error) {
        var err = eval("(" + xhr.responseText + ")");
        alert(err.Message);
      }
    });
  }


  function updateClient(id) {
    $.ajax({
      url: "./dependencies/update-dependencies",
      type: "POST",
      data: {

        operation_name_call: $("#operation_name_call"+id).val(),
        operation_name: $("#operation_name"+id).val(),
        integration_status: $("#integration_status"+id).val(),
        comments: $("#comments"+id).val(),
        id: id
      },
      success: function (data) {
        if (data) {
          if(data.status == "ok"){
            window.location="./dependencies"
          }
          else{
            console.log(data);
            alert("Error!");
          }
        }
      },
      error: function (xhr, status, error) {
        var err = eval("(" + xhr.responseText + ")");
        alert(err.Message);
      }
    });
  }

  function getDependencies() {
    $.ajax({
      url: "./dependencies/get-dependencies",
      type: "GET",
      data: {

      },
      success: function (data) {
        if (data) {
          if(data.status == "ok"){
            $.each(data.data, function( index, data ) {
              $( "#dependenciesTable" ).append(
                '<tr> <td><h2><a href="#">'+data.operation_name_call+'<span></span></a></h2></td> <td>'+data.operation_name+'</td> <td>'+data.integration_status +'</td> <td>'+data.date_added+'</td> <td>'+data.comments+'</td> <td class="text-right"> <div class="dropdown"> <a href="#" class="action-icon dropdown-toggle" data-toggle="dropdown" aria-expanded="false"><i class="fa fa-ellipsis-v"></i></a> <ul class="dropdown-menu pull-right"> <li><a href="#" data-toggle="modal" data-target="#edit_employee'+data.dependencies_id+'"><i class="fa fa-pencil m-r-5"></i> Edit</a></li> <li><a href="#" data-toggle="modal" data-target="#delete_employee'+data.dependencies_id+'"><i class="fa fa-trash-o m-r-'+data.dependencies_id+'"></i> Delete</a></li> </ul> </div> </td> </tr>'
              );
              $( "#editDependencies" ).append(
                '<div id="edit_employee'+data.dependencies_id+'" class="modal custom-modal fade" role="dialog"> <div class="modal-dialog"> <button type="button" class="close" data-dismiss="modal">&times;</button> <div class="modal-content modal-lg"> <div class="modal-header"> <h4 class="modal-title">Edit Dependencies</h4> </div> <div class="modal-body"> <form class="m-b-30"> <div class="row"> <hr style="border: 0.5px solid #ffa351;"/> <div class="modal-header"> <h4 class="modal-title">Product Details</h4> </div> <div class="col-sm-6"> <div class="form-group"> <label class="control-label">Operation Name Calls <span class="text-danger">*</span></label> <select id=operation_name_call'+data.dependencies_id+' class="select operation_name"> </select> </div> </div> <div class="col-sm-6"> <div class="form-group"> <label class="control-label">Operation Name <span class="text-danger">*</span></label> <select id=operation_name'+data.dependencies_id+' class="select operation_name"> </select> </div> </div> <div class="col-sm-6"> <div class="form-group"> <label class="control-label">Integration Status <span class="text-danger">*</span></label> <select value="'+data.integration_status+'" id=integration_status'+data.dependencies_id+' class="select"> <option value="Idea">Idea</option><option value="Planned">Planned</option> <option value="Specified">Specified</option> <option value="In Build">In Build</option> <option value="In Test">In Test</option> <option value="Deprecated">Deprecated</option> <option value="Done">Done</option> </select> </div> </div> <div class="col-sm-6"> <div class="form-group"> <label class="control-label">Comments</label> <input value="'+data.comments+'" id=comments'+data.dependencies_id+' class="form-control" type="text"> </div> </div> </div> <div class="m-t-20 text-center"> <button type="button" onclick="updateClient('+data.dependencies_id+');" class="btn btn-primary">Save Changes</button> </div> </form> </div> </div> </div> </div>'
              );
              $( "#deleteDependencies" ).append(
                '<div id="delete_employee'+data.dependencies_id+'" class="modal custom-modal fade" role="dialog"> <div class="modal-dialog"> <div class="modal-content modal-md"> <div class="modal-header"> <h4 class="modal-title">Delete Buyer</h4> </div> <form> <div class="modal-body card-box"> <p>Are you sure want to delete this?</p> <div class="m-t-20"> <a href="#" class="btn btn-default" data-dismiss="modal">Close</a> <button type="button" onclick="deleteClient('+data.dependencies_id+');" class="btn btn-danger">Delete</button> </div> </div> </form> </div> </div> </div>'
              );
              ($('#integration_status'+data.dependencies_id).val(data.integration_status).trigger('change'));
              ($('#operation_name_call'+data.dependencies_id).val(data.operation_name_call).trigger('change'));
              ($('#operation_name'+data.dependencies_id).val(data.operation_name).trigger('change'));
            });
          }
          else{
            console.log(data);
            alert("Error!");
          }
        }
      },
      error: function (xhr, status, error) {
        var err = eval("(" + xhr.responseText + ")");
        alert(err.Message);
      }
    });
  }

  function getOperations() {
    $.ajax({
      url: "./operations/get-operations",
      type: "GET",
      data: {

      },
      success: function (data) {
        if (data) {
          if(data.status == "ok"){
            $.each(data.data, function( index, data ) {
              $( ".operation_name" ).append(
                '<option value='+data.operation_name+'>'+data.operation_name+'</option>'
              );
            });
          }
          else{
            console.log(data);
            alert("Error!");
          }
        }
      },
      error: function (xhr, status, error) {
        var err = eval("(" + xhr.responseText + ")");
        alert(err.Message);
      }
    });
  }


  getDependencies();
  getOperations();

</script>
</body>

</html>

